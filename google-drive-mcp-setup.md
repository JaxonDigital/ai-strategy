# Google Drive MCP Server Setup - GAT-314

**Date:** October 20, 2025
**MCP Server:** @piotr-agier/google-drive-mcp v1.1.1
**Status:** âœ… Configured and Authenticated

## Installation Summary

### 1. MCP Server Installed
- Package: `@piotr-agier/google-drive-mcp`
- Version: 1.1.1
- Installation method: npx (auto-installs on demand)

### 2. Google Cloud Project Created
- **Project Name:** Jaxon Digital Medium Workflow
- **Project ID:** [Auto-generated by Google]
- **APIs Enabled:** Google Drive API

### 3. OAuth 2.0 Credentials Configured
- **Application Type:** Desktop app
- **Client Name:** MCP Google Drive Server
- **Credentials File:** `/Users/bgerby/Documents/dev/ai/.google-oauth-credentials.json`
- **Scopes Granted:**
  - `https://www.googleapis.com/auth/drive`
  - `https://www.googleapis.com/auth/drive.file`
  - `https://www.googleapis.com/auth/drive.readonly`
  - `https://www.googleapis.com/auth/documents`
  - `https://www.googleapis.com/auth/spreadsheets`
  - `https://www.googleapis.com/auth/presentations`

### 4. Authentication Tokens Saved
- **Token Location:** `/Users/bgerby/.config/google-drive-mcp/tokens.json`
- **Authentication Status:** âœ… Active
- **Token Type:** OAuth 2.0 with refresh token

### 5. MCP Configuration
**File:** `/Users/bgerby/Documents/dev/ai/.mcp.json`

```json
{
  "mcpServers": {
    "playwright": {
      "command": "npx",
      "args": [
        "-y",
        "@executeautomation/playwright-mcp-server"
      ]
    },
    "google-drive": {
      "command": "npx",
      "args": [
        "-y",
        "@piotr-agier/google-drive-mcp"
      ],
      "env": {
        "GOOGLE_DRIVE_OAUTH_CREDENTIALS": "/Users/bgerby/Documents/dev/ai/.google-oauth-credentials.json"
      }
    }
  }
}
```

## Available MCP Tools

The Google Drive MCP server provides these tools for use in Claude Code:

### File Operations
- `gdrive_upload_file` - Upload files to Google Drive
- `gdrive_download_file` - Download files from Google Drive
- `gdrive_delete_file` - Delete files
- `gdrive_move_file` - Move files between folders
- `gdrive_rename_file` - Rename files
- `gdrive_copy_file` - Copy files

### Folder Operations
- `gdrive_create_folder` - Create new folders
- `gdrive_list_files` - List files in a folder
- `gdrive_search_files` - Search for files

### Sharing & Permissions
- `gdrive_share_file` - Share files and get shareable links
- `gdrive_get_file_metadata` - Get file details

### Google Docs Integration
- `gdrive_create_doc` - Create Google Docs
- `gdrive_read_doc` - Read Google Docs content
- `gdrive_update_doc` - Update Google Docs

### Google Sheets Integration
- `gdrive_create_sheet` - Create Google Sheets
- `gdrive_read_sheet` - Read sheet data
- `gdrive_update_sheet` - Update sheet data

## Usage in Scripts

To use the MCP server from Python scripts, we'll integrate via MCP protocol. Example usage pattern:

```python
# This will be implemented in Phase 3
import mcp_client

# Upload file
file_id = mcp_client.call_tool('gdrive_upload_file', {
    'file_path': '/path/to/file.pdf',
    'parent_folder_id': 'folder_id_here',
    'name': 'GAT-234-article.pdf'
})

# Get shareable link
link = mcp_client.call_tool('gdrive_share_file', {
    'file_id': file_id,
    'permission_type': 'anyone',
    'role': 'reader'
})

print(f"File uploaded: {link}")
```

## Testing the Setup

### Manual Test (via Claude Code)
The MCP server is now available in Claude Code. You can test it by asking Claude to:
1. List files in your Google Drive
2. Create a test folder
3. Upload a file
4. Get a shareable link

### Re-authentication
If tokens expire (Google "Testing" apps expire after 7 days), re-run:
```bash
GOOGLE_DRIVE_OAUTH_CREDENTIALS="/Users/bgerby/Documents/dev/ai/.google-oauth-credentials.json" \
npx -y @piotr-agier/google-drive-mcp auth
```

## Security Notes

### Files to Keep Secure
- `.google-oauth-credentials.json` - OAuth client secret (DO NOT commit to git)
- `~/.config/google-drive-mcp/tokens.json` - Access/refresh tokens (DO NOT commit to git)

### .gitignore Entries
Add these to `/Users/bgerby/Documents/dev/ai/.gitignore`:
```
.google-oauth-credentials.json
*.json
```

## Token Expiration

**Important:** Google OAuth apps in "Testing" status have refresh tokens that expire after 7 days.

**Options:**
1. **Re-authenticate every 7 days** (run `auth` command)
2. **Publish the app** (requires Google verification - not recommended for internal tools)
3. **Use service account** (future enhancement - better for production)

## Troubleshooting

### "No token file found"
Run the auth command:
```bash
GOOGLE_DRIVE_OAUTH_CREDENTIALS="/Users/bgerby/Documents/dev/ai/.google-oauth-credentials.json" \
npx -y @piotr-agier/google-drive-mcp auth
```

### "Invalid credentials"
1. Verify credentials file exists: `ls -l /Users/bgerby/Documents/dev/ai/.google-oauth-credentials.json`
2. Check OAuth client is still active in Google Cloud Console
3. Re-download credentials if needed

### "Token expired"
Tokens expire after 7 days for Testing apps. Re-run auth command.

## Next Steps (Phase 2)

Now that the MCP server is configured, next task is GAT-315:
- Create Google Drive folder structure
- Set up "Medium Articles" folders
- Get folder IDs for script integration

---

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
